<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>计算机网络 - hao</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="hao"><meta name="msapplication-TileImage" content="/img/2751710164138_.pic.jpg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="hao"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content=""><meta property="og:type" content="blog"><meta property="og:title" content="hao"><meta property="og:url" content="https://jerryzhu1229.github.io/2024/03/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><meta property="og:site_name" content="hao"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://jerryzhu1229.github.io/pic/osi-7-model.png"><meta property="og:image" content="https://jerryzhu1229.github.io/pic/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5q2j5pyI5Y2B5YWt5bel5L2c5a6k,size_17,color_FFFFFF,t_70,g_se,x_16.png"><meta property="og:image" content="https://jerryzhu1229.github.io/pic/v2-85e9f94be74d1785c19e691d326989eb_720w.webp"><meta property="og:image" content="https://jerryzhu1229.github.io/pic/v2-8eae53249a1b8105f3892dff7c9b633a_720w.webp"><meta property="og:image" content="https://jerryzhu1229.github.io/pic/v2-3bf40bb2a0129174b33011788075deea_720w.jpg"><meta property="og:image" content="https://jerryzhu1229.github.io/pic/v2-bbd5783433756c20a381f85c901152c2_720w.webp"><meta property="og:image" content="https://jerryzhu1229.github.io/pic/format,png-20230309230534096.png"><meta property="og:image" content="https://jerryzhu1229.github.io/pic/Center-20240316124003287.png"><meta property="og:image" content="https://jerryzhu1229.github.io/pic/Center-20240316124102355.png"><meta property="article:published_time" content="2024-03-11T14:13:52.000Z"><meta property="article:modified_time" content="2024-03-16T04:41:40.081Z"><meta property="article:author" content="Jerry Z"><meta property="article:tag" content="面经"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://jerryzhu1229.github.io/pic/osi-7-model.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://jerryzhu1229.github.io/2024/03/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"},"headline":"计算机网络","image":["https://jerryzhu1229.github.io/pic/osi-7-model.png","https://jerryzhu1229.github.io/pic/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5q2j5pyI5Y2B5YWt5bel5L2c5a6k,size_17,color_FFFFFF,t_70,g_se,x_16.png","https://jerryzhu1229.github.io/pic/v2-85e9f94be74d1785c19e691d326989eb_720w.webp","https://jerryzhu1229.github.io/pic/v2-8eae53249a1b8105f3892dff7c9b633a_720w.webp","https://jerryzhu1229.github.io/pic/v2-3bf40bb2a0129174b33011788075deea_720w.jpg","https://jerryzhu1229.github.io/pic/v2-bbd5783433756c20a381f85c901152c2_720w.webp","https://jerryzhu1229.github.io/pic/format,png-20230309230534096.png","https://jerryzhu1229.github.io/pic/Center-20240316124003287.png","https://jerryzhu1229.github.io/pic/Center-20240316124102355.png"],"datePublished":"2024-03-11T14:13:52.000Z","dateModified":"2024-03-16T04:41:40.081Z","author":{"@type":"Person","name":"Jerry Z"},"publisher":{"@type":"Organization","name":"hao","logo":{"@type":"ImageObject","url":"https://jerryzhu1229.github.io/img/2751710164138_.pic.jpg"}},"description":""}</script><link rel="canonical" href="https://jerryzhu1229.github.io/2024/03/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><link rel="icon" href="/img/2751710164138_.pic.jpg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/2751710164138_.pic.jpg" alt="hao" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">文章</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/categories/cs">计算机基础</a><a class="navbar-item" href="/categories/java">后端开发</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/jerryzhu1229"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-03-11T14:13:52.000Z" title="2024/3/11 22:13:52">2024-03-11</time>发表</span><span class="level-item"><time dateTime="2024-03-16T04:41:40.081Z" title="2024/3/16 12:41:40">2024-03-16</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/cs/">cs</a></span><span class="level-item">26 分钟读完 (大约3939个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">计算机网络</h1><div class="content"><html><head></head><body><h2 id="OSI七层和作用"><a href="#OSI七层和作用" class="headerlink" title="*OSI七层和作用"></a>*OSI七层和作用</h2><p><img src="/../pic/osi-7-model.png" alt="OSI 七层模型"></p>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><h3 id="访问网页全过程"><a href="#访问网页全过程" class="headerlink" title="**访问网页全过程"></a>**访问网页全过程</h3><ol>
<li>根据 url 通过 DNS 协议获取对应 IP地址（DNS 查找过程：浏览器缓存、路由器缓存、DNS 缓存）</li>
<li>根据 IP 地址+端口号，发送 TCP 连接请求</li>
<li>建立连接后，发送 HTTP请求报文，请求获取网页信息</li>
<li>服务器端收到 HTTP 请求报文后，处理请求，返回 HTTP 响应报文</li>
<li>浏览器根据 HTTP 响应报文，<strong>解析</strong>响应体中的 HTML 代码，<strong>渲染</strong>网页的结构和样式，根据 HTML 中的其他资源的 URL，再次发起 HTTP 请求，获取这些资源</li>
<li>浏览器在不需要和服务器通信时，可以主动关闭 TCP 连接，或者等待服务器的关闭请求</li>
</ol>
<p><strong>应用层</strong></p>
<p>DNS（Domain Name System）： 解决域名和 IP 地址的映射</p>
<p>HTTP：根据 DNS获取的目标主机的 IP 发送 HTTP 报文</p>
<p><strong>传输层</strong></p>
<p>HTTP 基于 TCP，数据要经过这俩个协议的封装</p>
<p><strong>网络层</strong></p>
<p>应用层、传输层是端到端协议；网络层是中间件协议，主机与中间系统进行交互。</p>
<p>网络层的核心功能：<code>路由选择</code>和<code>分组转发</code></p>
<p><code>路由选择</code>：确定分组从源到目的最优路径的过程</p>
<p><code>分组转发</code>：将分组从路由器的输入端口转移到合适的输出端口</p>
<p><img src="/../pic/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5q2j5pyI5Y2B5YWt5bel5L2c5a6k,size_17,color_FFFFFF,t_70,g_se,x_16.png" alt="img"></p>
<p><strong>往哪里传输？或者说，要把数据包发到哪个路由器上？</strong>（怎么路由）</p>
<p><img src="/../pic/v2-85e9f94be74d1785c19e691d326989eb_720w.webp" alt="img"></p>
<ol>
<li>根据报文的目标 IP 地址跟路由表每个表项的掩码字段做“与”操作，判断是否匹配该表项的目标 IP 地址。</li>
<li>匹配完所有的表项选择<strong>掩码最长的匹配项</strong>，根据该表项的出接口和下一跳路由 IP将报文转发；若没有匹配到，则查找是否有<strong>缺省路由</strong>；若都没有，则<strong>丢弃</strong>报文</li>
</ol>
<p><strong>路由表项怎么来的？</strong></p>
<p>direct：链路层发现，优点：自动发现，开销小。缺点：只发现接口所属网段</p>
<p>static：静态路由，需要人为调整</p>
<p>缺省路由</p>
<p>动态路由：RIP（<strong>Routing Information Protocol</strong>使用跳数作为路径距离）、OSPF（<strong>Open Shortest Path First</strong>链路开销值判断路径长短）和 BGP（<strong>Border Gateway Protocol</strong>边界网关协议，在路由选择域之间交换网络层可达性信息）</p>
<h3 id="HTTP-vs-HTTPS（应用层）"><a href="#HTTP-vs-HTTPS（应用层）" class="headerlink" title="**HTTP vs HTTPS（应用层）"></a>**HTTP vs HTTPS（应用层）</h3><h4 id="HTTP-1"><a href="#HTTP-1" class="headerlink" title="HTTP"></a>HTTP</h4><p>HTTP 协议，全称超文本传输协议（Hypertext Transfer Protocol）。顾名思义，HTTP 协议就是用来规范超文本的传输，超文本，也就是网络上的包括文本在内的各式各样的消息。</p>
<p>HTTP 协议优点：扩展性强、速度快、跨平台支持性好。</p>
<h4 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h4><p>HTTPS 协议（Hyper Text Transfer Protocol Secure），是 HTTP 的加强安全版本。HTTPS 是基于 HTTP 的，也是用 TCP 作为底层协议，并额外使用 SSL/TLS 协议用作加密和安全认证。默认端口号是 443.</p>
<p>HTTPS 协议中，SSL 通道通常使用基于密钥的加密算法，密钥长度通常是 40 比特或 128 比特。</p>
<p>HTTPS协议优点：保密性好、信任度高。</p>
<h4 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h4><ul>
<li>端口：80   443</li>
<li>url 前缀：http://    https//</li>
<li>安全性：HTTP 运行在 TCP，明文传输，无法验证身份。HTTPS 采用SSL/TLS，<strong>传输内容对称加密，但对称加密的密钥是用服务器方的证书进行非对称加密</strong></li>
<li>SEO（搜索引擎优化）：搜索引擎通常会更青睐使用 HTTPS 协议的网站</li>
</ul>
<h3 id="SSL-TLS"><a href="#SSL-TLS" class="headerlink" title="SSL/TLS"></a>SSL/TLS</h3><p>解决了 HTTP 数据透明的问题</p>
<h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><p><strong>流程</strong></p>
<p><img src="/../pic/v2-8eae53249a1b8105f3892dff7c9b633a_720w.webp" alt="img"></p>
<p><strong>非对称加密</strong></p>
<p>SSL/TLS 的核心要素是<strong>非对称加密</strong>。非对称加密采用两个密钥——一个公钥，一个私钥。公钥加密的内容，使用私钥可以解开；而私钥加密的内容，公钥可以解开。目前使用最为广泛的非对称密钥为<code>RSA</code>算法。</p>
<p><strong>对称加密</strong></p>
<p>使用 SSL/TLS 进行通信的双方需要使用非对称加密方案来通信，但是非对称加密设计了较为复杂的数学算法，在实际通信过程中，计算的代价较高，效率太低，因此，SSL/TLS 实际对消息的加密使用的是对称加密。</p>
<p><strong>hash算法加密</strong></p>
<p>它是一种不可逆的加密方式，对一组数据使用哈希算法加密，加密后不能解密</p>
<p><strong>保证公钥传输的信赖性（*数字签名&amp;数字证书）</strong></p>
<ol>
<li><p>CA 发放证书</p>
<p><img src="/../pic/v2-3bf40bb2a0129174b33011788075deea_720w.jpg" alt="img"></p>
<p>服务器把证书内容给 CA，利用 hash算法 +私钥生成签名。</p>
<p>数字证书=证书内容+证书签名</p>
</li>
<li><p>服务器发送数字证书给客户端</p>
</li>
<li><p>客户端验证证书</p>
<p><img src="/../pic/v2-bbd5783433756c20a381f85c901152c2_720w.webp" alt="img"></p>
<p>hash算法加密证书内容，CA 公钥解密证书签名，判断是否相同</p>
</li>
</ol>
<h3 id="HTTP-和-RPC-有什么区别"><a href="#HTTP-和-RPC-有什么区别" class="headerlink" title="HTTP 和 RPC 有什么区别"></a>HTTP 和 RPC 有什么区别</h3><p> RPC，因为它定制化程度更高，可以采用体积更小的 Protobuf 或其他序列化协议去保存结构体数据，同时也不需要像 HTTP 那样考虑各种浏览器行为，比如 302 重定向跳转啥的。<strong>因此性能也会更好一些，这也是在公司内部微服务中抛弃 HTTP，选择使用 RPC 的最主要原因。</strong></p>
<p><strong>HTTP 主要用于 B/S 架构，而 RPC 更多用于 C/S 架构。但现在其实已经没分那么清了，B/S 和 C/S 在慢慢融合</strong>。很多软件同时支持多端，所以对外一般用 HTTP 协议，而内部集群的微服务之间则采用 RPC 协议进行通讯。</p>
<h3 id="HTTP-常见状态码"><a href="#HTTP-常见状态码" class="headerlink" title="*HTTP 常见状态码"></a>*HTTP 常见状态码</h3><p>200 OK：请求已正常处理。</p>
<p>204 No Content：请求处理成功，但没有任何资源可以返回给客户端</p>
<p>301 Moved Permanently 永久性重定向</p>
<p>302 Found 临时性重定向</p>
<p>304（未修改）</p>
<p>400 Bad Request：服务器端无法理解客户端发送的请求。请求报文中可能存在语法错误。</p>
<p>403 Forbidden：不允许访问那个资源。权限，未授权IP等</p>
<p>404 Not Found：服务器上没有请求的资源。路径错误</p>
<p>502 Bad Gateway</p>
<ol>
<li>后端服务器故障（ping、telnet、curl）</li>
<li>nginx配置问题（nginx.conf、查看日志）</li>
<li>高负载或者资源耗尽（top）</li>
<li>nginx与后端服务器通信问题（查看防火墙）</li>
</ol>
<p>503服务不可用（由于超载或停机维护）</p>
<p>504 Gateway timeout 网关超时</p>
<ul>
<li>一般指nginx做反向代理服务器时，所连接的服务器tomcat无响应导致的。</li>
<li>为了完成您的 HTTP 请求，该服务器访问一个上游服务器，但没得到及时的响应</li>
<li>nginx超过了自己设置的超时时间</li>
</ul>
<h2 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h2><h3 id="TCP-头部格式"><a href="#TCP-头部格式" class="headerlink" title="TCP 头部格式"></a>TCP 头部格式</h3><p><img src="/../pic/format,png-20230309230534096.png" alt="TCP 头格式"></p>
<p><strong>序列号</strong>：在建立连接时由计算机生成的随机数作为其初始值，通过 SYN 包传给接收端主机，每发送一次数据，就「累加」一次该「数据字节数」的大小。<strong>用来解决网络包乱序问题。</strong></p>
<p><strong>确认应答号</strong>：指下一次「期望」收到的数据的序列号，发送端收到这个确认应答以后可以认为在这个序号以前的数据都已经被正常接收。<strong>用来解决丢包的问题。</strong></p>
<p><strong>控制位：</strong></p>
<ul>
<li><em>ACK</em>：该位为 <code>1</code> 时，「确认应答」的字段变为有效，TCP 规定除了最初建立连接时的 <code>SYN</code> 包之外该位必须设置为 <code>1</code> 。</li>
<li><em>RST</em>：该位为 <code>1</code> 时，表示 TCP 连接中出现异常必须强制断开连接。</li>
<li><em>SYN</em>：该位为 <code>1</code> 时，表示希望建立连接，并在其「序列号」的字段进行序列号初始值的设定。</li>
<li><em>FIN</em>：该位为 <code>1</code> 时，表示今后不会再有数据发送，希望断开连接。当通信结束希望断开连接时，通信双方的主机之间就可以相互交换 <code>FIN</code> 位为 1 的 TCP 段。</li>
</ul>
<h3 id="为什么需要-TCP-协议？-TCP-工作在哪一层？"><a href="#为什么需要-TCP-协议？-TCP-工作在哪一层？" class="headerlink" title="为什么需要 TCP 协议？ TCP 工作在哪一层？"></a>为什么需要 TCP 协议？ TCP 工作在哪一层？</h3><p>网络层不可靠，如果需要保障网络数据包的可靠性，那么就需要由上层（传输层）的 <code>TCP</code> 协议来负责。</p>
<h3 id="为什么要三次握手？不是两次或者四次"><a href="#为什么要三次握手？不是两次或者四次" class="headerlink" title="为什么要三次握手？不是两次或者四次"></a>为什么要三次握手？不是两次或者四次</h3><p>SYN 同步序列编号(Synchronize Sequence Numbers) 是 TCP/IP 建立连接时使用的握手信号。客户机首先发出一个 SYN 消息，服务器使用 SYN-ACK 应答表示接收到了这个消息，最后客户机再以 ACK(Acknowledgement）消息响应</p>
<p>三次握手最主要的目的就是双方确认自己与对方的发送与接收是正常的。</p>
<ul>
<li>第一次握手：Client 什么都不能确认；Server 确认了对方发送正常，自己接收正常</li>
<li>第二次握手：Client 确认了：自己发送、接收正常，对方发送、接收正常；Server 确认了：对方发送正常，自己接收正常</li>
<li>第三次握手：Client 确认了：自己发送、接收正常，对方发送、接收正常；Server 确认了：自己发送、接收正常，对方发送、接收正常</li>
</ul>
<p>不使用「两次握手」和「四次握手」的原因：</p>
<ul>
<li>「两次握手」：无法防止历史连接的建立，会造成双方资源的浪费，也无法可靠的同步双方序列号；</li>
<li>「四次握手」：三次握手就已经理论建立可靠连接，所以不需要使用更多的通信次数。</li>
</ul>
<h3 id="为什么挥手需要四次？"><a href="#为什么挥手需要四次？" class="headerlink" title="为什么挥手需要四次？"></a>为什么挥手需要四次？</h3><p>再来回顾下四次挥手双方发 <code>FIN</code> 包的过程，就能理解为什么需要四次了。</p>
<ul>
<li>关闭连接时，客户端向服务端发送 <code>FIN</code> 时，仅仅表示客户端不再发送数据了但是还能接收数据。</li>
<li>服务端收到客户端的 <code>FIN</code> 报文时，先回一个 <code>ACK</code> 应答报文，而服务端可能还有数据需要处理和发送，等服务端不再发送数据时，才发送 <code>FIN</code> 报文给客户端来表示同意现在关闭连接。</li>
</ul>
<p>从上面过程可知，服务端通常需要等待完成数据的发送和处理，所以服务端的 <code>ACK</code> 和 <code>FIN</code> 一般都会分开发送，因此是需要四次挥手。</p>
<h3 id="为什么第四次挥手客户端需要等待-2-MSL（报文段最长寿命）"><a href="#为什么第四次挥手客户端需要等待-2-MSL（报文段最长寿命）" class="headerlink" title="为什么第四次挥手客户端需要等待 2*MSL（报文段最长寿命）"></a>为什么第四次挥手客户端需要等待 2*MSL（报文段最长寿命）</h3><ul>
<li>确保服务端收到客户端的 ack</li>
<li>确保上一次的 tcp 报文信息不会影响下一次的 tcp 连接</li>
</ul>
<h3 id="TCP-如何保证传输的可靠性？"><a href="#TCP-如何保证传输的可靠性？" class="headerlink" title="TCP 如何保证传输的可靠性？"></a>TCP 如何保证传输的可靠性？</h3><ul>
<li>基于数据块传输</li>
<li>对失序数据包重排以及去重</li>
<li>校验和</li>
<li>重传机制</li>
<li>流量控制</li>
<li>拥塞控制</li>
</ul>
<h3 id="TCP-如何实现流量控制？"><a href="#TCP-如何实现流量控制？" class="headerlink" title="TCP 如何实现流量控制？"></a><a target="_blank" rel="noopener" href="https://javaguide.cn/cs-basics/network/tcp-reliability-guarantee.html#tcp-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6">TCP 如何实现流量控制？</a></h3><p><strong>TCP 利用滑动窗口实现流量控制。流量控制是为了控制发送方发送速率，保证接收方来得及接收。</strong> 接收方发送的确认报文中的窗口字段可以用来控制发送方窗口大小，从而影响发送方的发送速率。将窗口字段设置为 0，则发送方不能发送数据。</p>
<p>TCP 为全双工(Full-Duplex, FDX)通信，双方可以进行双向通信，客户端和服务端既可能是发送端又可能是服务端。因此，两端各有一个发送缓冲区与接收缓冲区，两端都各自维护一个发送窗口和一个接收窗口。</p>
<p><strong>TCP 发送窗口可以划分成四个部分</strong>：</p>
<ol>
<li>已经发送并且确认的 TCP 段（已经发送并确认）；</li>
<li>已经发送但是没有确认的 TCP 段（已经发送未确认）；</li>
<li>未发送但是接收方准备接收的 TCP 段（可以发送）；</li>
<li>未发送并且接收方也并未准备接受的 TCP 段（不可发送）</li>
</ol>
<p><strong>TCP 接收窗口可以划分成三个部分</strong>：</p>
<ol>
<li>已经接收并且已经确认的 TCP 段（已经接收并确认）；</li>
<li>等待接收且允许发送方发送 TCP 段（可以接收未确认）；</li>
<li>不可接收且不允许发送方发送 TCP 段（不可接收）。</li>
</ol>
<h3 id="TCP-的拥塞控制是怎么实现的？"><a href="#TCP-的拥塞控制是怎么实现的？" class="headerlink" title="TCP 的拥塞控制是怎么实现的？"></a><a target="_blank" rel="noopener" href="https://javaguide.cn/cs-basics/network/tcp-reliability-guarantee.html#tcp-%E7%9A%84%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6%E6%98%AF%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E7%9A%84">TCP 的拥塞控制是怎么实现的？</a></h3><p><strong>拥塞控制</strong>，控制的目的就是<strong>避免「发送方」的数据填满整个网络。</strong></p>
<p>为了在「发送方」调节所要发送数据的量，定义了一个叫做「<strong>拥塞窗口</strong>」的概念。</p>
<p>拥塞控制主要是四个算法:</p>
<ul>
<li>慢启动：<strong>当发送方每收到一个 ACK，拥塞窗口 cwnd 的大小就会加 1。</strong>指数性的增长</li>
<li>拥塞避免：<strong>每当收到一个 ACK 时，cwnd 增加 1/cwnd。</strong>线性增长</li>
<li>快速重传：当接收方发现丢了一个中间包的时候，重复3 次发送前一个包的 ACK，于是发送端就会快速地重传，不必等待超时再重传。这种情况下网络阻塞不严重，将ssthresh慢开始门限<code>设为</code>cwnd/2，cwnd<code> 重置为</code>ssthresh，进入快速恢复算法。</li>
<li>快速恢复：由于发送方现在认为网络很可能没有发生拥塞（如果网络发生了严重拥塞，就不会一连有好几个报文段连续到达接收方，也就不会导致接收方连续发送重复确认）。将 cwnd 变为 ssthresh，开始拥塞避免</li>
</ul>
<p><img src="/../pic/Center-20240316124003287.png" alt="img"></p>
<p><img src="/../pic/Center-20240316124102355.png" alt="img"></p>
<h3 id="粘包-拆包"><a href="#粘包-拆包" class="headerlink" title="粘包/拆包"></a>粘包/拆包</h3><p>因为TCP是面向流，没有边界，而操作系统在发送TCP数据时，会通过缓冲区来进行优化，例如缓冲区为1024个字节大小。</p>
<p>如果一次请求发送的数据量比较小，没达到缓冲区大小，TCP则会将多个请求合并为同一个请求进行发送，这就形成了粘包问题。</p>
<p>如果一次请求发送的数据量比较大，超过了缓冲区大小，TCP就会将其拆分为多次发送，这就是拆包。</p>
<p>解决：</p>
<ol>
<li>粘包：固定包的长度，不足用 0 填充</li>
<li>拆包：设置固定分隔符号（FTP 协议）</li>
</ol>
</body></html></div><div class="article-licensing box"><div class="licensing-title"><p>计算机网络</p><p><a href="https://jerryzhu1229.github.io/2024/03/11/计算机网络/">https://jerryzhu1229.github.io/2024/03/11/计算机网络/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Jerry Z</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2024-03-11</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2024-03-16</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E9%9D%A2%E7%BB%8F/">面经</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2024/03/12/Java%E5%9F%BA%E7%A1%80/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Java基础</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2024/03/11/%E9%9D%A2%E7%BB%8F/"><span class="level-item">面经</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-3-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#OSI七层和作用"><span class="level-left"><span class="level-item">1</span><span class="level-item">*OSI七层和作用</span></span></a></li><li><a class="level is-mobile" href="#HTTP"><span class="level-left"><span class="level-item">2</span><span class="level-item">HTTP</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#访问网页全过程"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">**访问网页全过程</span></span></a></li><li><a class="level is-mobile" href="#HTTP-vs-HTTPS（应用层）"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">**HTTP vs HTTPS（应用层）</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#HTTP-1"><span class="level-left"><span class="level-item">2.2.1</span><span class="level-item">HTTP</span></span></a></li><li><a class="level is-mobile" href="#HTTPS"><span class="level-left"><span class="level-item">2.2.2</span><span class="level-item">HTTPS</span></span></a></li><li><a class="level is-mobile" href="#区别"><span class="level-left"><span class="level-item">2.2.3</span><span class="level-item">区别</span></span></a></li></ul></li><li><a class="level is-mobile" href="#SSL-TLS"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">SSL/TLS</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#工作原理"><span class="level-left"><span class="level-item">2.3.1</span><span class="level-item">工作原理</span></span></a></li></ul></li><li><a class="level is-mobile" href="#HTTP-和-RPC-有什么区别"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">HTTP 和 RPC 有什么区别</span></span></a></li><li><a class="level is-mobile" href="#HTTP-常见状态码"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">*HTTP 常见状态码</span></span></a></li></ul></li><li><a class="level is-mobile" href="#TCP"><span class="level-left"><span class="level-item">3</span><span class="level-item">TCP</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#TCP-头部格式"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">TCP 头部格式</span></span></a></li><li><a class="level is-mobile" href="#为什么需要-TCP-协议？-TCP-工作在哪一层？"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">为什么需要 TCP 协议？ TCP 工作在哪一层？</span></span></a></li><li><a class="level is-mobile" href="#为什么要三次握手？不是两次或者四次"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">为什么要三次握手？不是两次或者四次</span></span></a></li><li><a class="level is-mobile" href="#为什么挥手需要四次？"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">为什么挥手需要四次？</span></span></a></li><li><a class="level is-mobile" href="#为什么第四次挥手客户端需要等待-2-MSL（报文段最长寿命）"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">为什么第四次挥手客户端需要等待 2*MSL（报文段最长寿命）</span></span></a></li><li><a class="level is-mobile" href="#TCP-如何保证传输的可靠性？"><span class="level-left"><span class="level-item">3.6</span><span class="level-item">TCP 如何保证传输的可靠性？</span></span></a></li><li><a class="level is-mobile" href="#TCP-如何实现流量控制？"><span class="level-left"><span class="level-item">3.7</span><span class="level-item">TCP 如何实现流量控制？</span></span></a></li><li><a class="level is-mobile" href="#TCP-的拥塞控制是怎么实现的？"><span class="level-left"><span class="level-item">3.8</span><span class="level-item">TCP 的拥塞控制是怎么实现的？</span></span></a></li><li><a class="level is-mobile" href="#粘包-拆包"><span class="level-left"><span class="level-item">3.9</span><span class="level-item">粘包/拆包</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/cs/"><span class="level-start"><span class="level-item">cs</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/java/"><span class="level-start"><span class="level-item">java</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/2751710164138_.pic.jpg" alt="hao" height="28"></a><p class="is-size-7"><span>&copy; 2024 Jerry Z</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>